<div class="menu-page">

    <h2 class="menu-title">üçΩ Qu·∫£n l√Ω th·ª±c ƒë∆°n</h2>

    <div class="menu-toolbar left-align">
        <input id="searchMenu" type="text" class="menu-input" placeholder="T√¨m m√≥n theo t√™n...">

        <select id="filterCategory" class="menu-select">
            <option value="all">T·∫•t c·∫£</option>
            <option value="C√† ph√™">C√† ph√™</option>
            <option value="Tr√†">Tr√†</option>
            <option value="S·ªØa">S·ªØa</option>
            <option value="ƒê·ªì ƒÉn">ƒê·ªì ƒÉn</option>
        </select>

        <button id="btnAdd" class="btn-primary">+ Th√™m m√≥n m·ªõi</button>
    </div>

<table class="menu-table" style="width: 100%; margin-top: 15px; border-collapse: collapse;">
    <thead>
        <tr>
            <th>·∫¢nh</th>
            <th>T√™n m√≥n</th>
            <th>Gi√°</th>
            <th>Danh m·ª•c</th>
            <th>Tr·∫°ng th√°i</th>
            <th>H√†nh ƒë·ªông</th>
        </tr>
    </thead>

    <tbody id="menuBody"></tbody>
</table>



        <div class="modal-actions">
            <button id="btnSave" class="btn-primary">L∆∞u</button>
            <button id="btnClose" class="btn-secondary">H·ªßy</button>
        </div>
    </div>
</div>
<script>
document.addEventListener("DOMContentLoaded", () => {

    const APP_KEY = "qr_order_demo_v1";

    const wrap = document.getElementById("menuGrid");
    const search = document.getElementById("searchMenu");
    const filter = document.getElementById("filterCategory");

    function getMenu(){
        const data = JSON.parse(localStorage.getItem(APP_KEY));
        return data?.menu || [];
    }

    function formatVND(n){
        return Number(n).toLocaleString("vi-VN") + " ‚Ç´";
    }

    function render(items){
        wrap.innerHTML = items.map(m => `
            <div class="admin-card">
                <img src="${m.img}" />

                <div class="admin-card-body">
                    <div class="admin-name">${m.name}</div>
                    <div class="admin-price">${formatVND(m.price)}</div>
                    <div class="admin-cat">${m.category}</div>

                    <button onclick="openMenuModal('edit', '${m.id}')">S·ª≠a</button>
                    <button onclick="deleteMenu('${m.id}')">X√≥a</button>
                </div>
            </div>
        `).join("");
    }

    function applyFilter(){
        let items = getMenu();

        const q = search.value.trim().toLowerCase();
        if (q) items = items.filter(m => m.name.toLowerCase().includes(q));

        const cat = filter.value;
        if (cat !== "all") items = items.filter(m => m.category === cat);

        render(items);
    }

    search.oninput = applyFilter;
    filter.onchange = applyFilter;

    applyFilter();
});


// ================= XO√Å M√ìN =================
function deleteMenu(id){
    if (!confirm("X√≥a m√≥n n√†y?")) return;

    const APP_KEY = "qr_order_demo_v1";
    const data = JSON.parse(localStorage.getItem(APP_KEY));

    data.menu = data.menu.filter(m => m.id != id);

    localStorage.setItem(APP_KEY, JSON.stringify(data));
    location.reload();
}
</script>
